<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>连续早起</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/index.css">
</head>
<body>
<div id="continuity" class="flexv mainbox wrap">
    <div class="flex user-head">
        <div class="flexv center user-left">
            <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
            <h2 class="flexv user-name">Vacant</h2>
            <span class="flex">连续365天 • 第999名</br>888赞</span>
        </div>
        <div class="flexitemv user-right">
            <div class="flexv center defeat">
                <div class="flex center"><i class="flex center dk ranking" style="color:#ffc118"></i>击败人数</div>
                <span class="number" style="color:#ffc118">0%</span>
            </div>
            <div class="around bottom">
                <div class="flexv center time">
                    <div class="flex center"><i class="flex center dk sj" style="color:#f08b70"></i>打卡时间</div>
                    <span class="number" style="color:#f08b70">17:35</span>
                </div>
                <i class="line"></i>
                <div class="flexv center total">
                    <div class="flex center"><i class="flex center dk clock" style="color:#2ee2cb"></i>累计天数</div>
                    <span class="number" style="color:#2ee2cb">0天</span>
                </div>
            </div>
        </div>
    </div>
    <div class="teambox">
        <div class="between t-title">
            <span>早起打卡</span>
            <a href="group.html" class="flex found">创建打卡团<i class="flex center dk right"></i></a>
        </div>
        <div class="between list">
            <div class="flex user-info">
                <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
                <div class="flexv user-name-site">
                    <div class="flexv name">壹贰叁肆伍陆柒捌玖拾</div>
                    <div class="flex site"><i class="flex center dk gps"></i><span class="flex center">江苏 无锡</span></div>
                </div>
            </div>
            <div class="flex end number"><i class="flex center dk num"></i>5人</div>
            <div class="flex center join">
                <a href="ranking.html" class="flex center dk right"></a>
            </div>
        </div>
        <div class="between list">
            <div class="flex user-info">
                <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
                <div class="flexv user-name-site">
                    <div class="flexv name">早起奋斗团</div>
                    <div class="flex site"><i class="flex center dk gps"></i><span class="flex center">江苏 无锡</span></div>
                </div>
            </div>
            <div class="flex end number"><i class="flex center dk num"></i>5人</div>
            <div class="flex center join">
                <a href="ranking.html" class="flex center dk right"></a>
            </div>
        </div>
    </div>
    <div class="flexv rankingbox">
        <div class="flex centerv r-title">打卡好友</div>
        <table class="list-box">
            <tr>
                <td><div class="flex center top"><img src="../image/top1.png" class="fitimg"></div></td>
                <td>
                    <div class="flex userbox">
                        <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
                       <div class="flexv centerh together">
                           <div class="flex name">Vacant</div>
                           <div class="day">共同打卡<span>365</span>天</div>
                       </div>
                    </div>
                </td>
                <td><span>09:22</span></td>
                <td>
                    <div class="flexv center praise">
                        <i class="flex center dk sx"></i>
                        <i>321</i>
                    </div>
                </td>
            </tr>
            <tr>
                <td><div class="flex top"><img src="../image/top2.png" class="fitimg"></div></td>
                <td>
                    <div class="flex userbox">
                        <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
                        <div class="flexv centerh together">
                            <div class="flex name">Vacant</div>
                            <div class="day">共同打卡<span>7</span>天</div>
                        </div>
                    </div>
                </td>
                <td><span>09:22</span></td>
                <td>
                    <div class="flexv center praise">
                        <i class="flex center dk kx"></i>
                        <i>321</i>
                    </div>
                </td>
            </tr>
            <tr>
                <td><div class="flex center top"><img src="../image/top3.png" class="fitimg"></div></td>
                <td>
                    <div class="flex userbox">
                        <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
                        <div class="flexv centerh together">
                            <div class="flex name">Vacant</div>
                            <div class="day">共同打卡<span>7</span>天</div>
                        </div>
                    </div>
                </td>
                <td><span>09:22</span></td>
                <td>
                    <div class="flexv center praise">
                        <span class="flex center hint">提醒打卡</span>
                    </div>
                </td>
            </tr>
            <tr>
                <td>4</td>
                <td>
                    <div class="flex userbox">
                        <div class="user-img"><img src="../image/user.jpg" class="radimg"></div>
                        <div class="flexv centerh together">
                            <div class="flex name">Vacant</div>
                            <div class="day">共同打卡<span>3</span>天</div>
                        </div>
                    </div>
                </td>
                <td><span>09:22</span></td>
                <td>
                    <div class="flexv center praise">
                        <span class="flex center no-hint">未打卡</span>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <a href="javascript:;" class="flex center create">生成打卡图</a>
</div>

<img src="" alt="打卡图" class="fitimg call" style="display:none;">
<img src="../image/call-up.jpg" class="fitimg call-up" style="display:none;">
<img src="../image/qrcode.png" class="fitimg qrcode" style="display:none;">
</body>
<script src="https://cdn.bootcss.com/jquery/3.3.0/jquery.min.js"></script>
<script src="../js/functions.js"></script>
<script type="text/javascript">
    // 爱心
    $('.praise i.dk').click(function () {
        let num = $(this).siblings();
        if($(this).hasClass('sx')){
            $(this).removeClass('sx').addClass('kx');
            num.text((parseInt(num.text())-1));
        }else{
            $(this).removeClass('kx').addClass('sx');
            num.text((parseInt(num.text())+1));
        }
    });

    // 打卡提醒
    $('.praise .hint').click(function () {
        if($(this).text() == '提醒打卡'){
            $(this).text("已提醒");
        }else{    // 已经提醒过提示
            let hinted = $(`<div class="hinted">已经提醒过啦~</div>`);
            $('#continuity').append(hinted);
            setTimeout(function () {
                $('.hinted').animate({'opacity':0},2500,"linear",function () {
                    $('.hinted').remove()
                },1000);
            });
        }
    });

    // 生成打卡图
    $('a.create').click(function(){
        showAlert('打卡图已发送', '前往公众号查看，召集好友加入打卡团', [{t:'关闭'}, {t:'查看'}]);
        // 生成打卡团图
        var can = document.createElement("canvas"),ctx = can.getContext("2d"),qrcode = document.querySelector(".qrcode");
        var imgs = new Image();
        imgs.src = document.querySelector(".call-up").src;
        imgs.onload = function () {
            //设置画布尺寸
            can.width = imgs.width;
            can.height = imgs.height;
            //绘制背景图
            ctx.drawImage(imgs, 0, 0);
            ctx.drawImage(qrcode, can.width-496, can.height-500, 260, 260);
            document.querySelector(".call").setAttribute('src',can.toDataURL('image/jpeg'));
            document.querySelector(".call").style.display="block";
            $('#continuity').hide();
        }
    });
</script>
</html>